@{
    ViewBag.Title = "Dashboard";
    Layout = "~/Areas/Estate/Views/Shared/_Layout.cshtml";
}

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jsrender/1.0.0-beta/jsrender.min.js"></script>
<script type="text/javascript" src="https://cdn.boldbi.com/embedded-sdk/v4.2.68/embed-js.js"></script>

<div class="container-fluid">
    <div id="dashboard-container" style="border: greenyellow">
        <p>Hello</p>
    </div>
    <h1>Test</h1>
</div>

    <script type="text/javascript">

        $(document).ready(function() { renderDashboard(); });
        
        function renderDashboard()
        {
            // TODO: make this config i think
            //For Bold BI Enterprise edition, it should be like `site/site1`. For Bold BI Cloud, it should be empty string.
            var siteIdentifier = "site/site1";

            //Your Bold BI application environment. (If Cloud, you should use `cloud`, if Enterprise, you should use `onpremise`)
            var environment = "onpremise";

            //Item id of the dashboard in the Bold BI server`
            var dashboardId = "2dc48752-a1bb-4d62-8bd9-96280039781c";

            var datasourceId = "651f6193-b2e4-4ccd-aa23-56996ce9a18f";

            // TODO: make this config i think
            //Bold BI Server URL (ex: http://localhost:5000/bi, http://demo.boldbi.com/bi)
            var rootUrl = "http://localhost:57239/bi/";

            // TODO: make this config i think
            //Url of the GetDetails(API) in this application
            var authorizationUrl = "https://192.168.0.10:5004/GetDetails";

            console.log('in renderDashboard');
            console.log(authorizationUrl);
            console.log(rootUrl);
            console.log(siteIdentifier);
            console.log(dashboardId);
            console.log(environment);

            try
            {
                var boldbiEmbedInstance = BoldBI.create({
                    serverUrl: rootUrl + siteIdentifier,
                    dashboardId: dashboardId,
                    embedContainerId: "dashboard-container", // This should be the container id where you want to embed the dashboard
                    embedType: BoldBI.EmbedType.Component,
                    environment: environment,
                    mode: BoldBI.Mode.View,
                    height: "800px",
                    width: "1200px",
                    dynamicConnection: {
                        isEnabled: true,
                        identity: datasourceId + "|" + @User.FindFirst("email")
                    },
                    authorizationServer: {
                        url: authorizationUrl
                    }
                });
                boldbiEmbedInstance.loadDashboard();
            }
            catch (error) {
                console.log(error);
            }
        }
    </script>